<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureCoder Pro - Advanced Encryption Tool</title>
    
    <!-- External Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* Base Styles */
        .gradient-bg {
            background: linear-gradient(135deg, #6e8efb, #a777e3);
        }
        
        /* Code Container & Copy Button Styles */
        .code-container {
            position: relative;
            padding: 40px 16px 16px;
            background-color: #1F2937;
            border-radius: 8px;
            margin-top: 8px;
        }

        .code-container pre {
            max-height: 400px;
            overflow-y: auto;
            margin: 0;
            padding: 0;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #e2e8f0;
            font-family: 'Courier New', monospace;
        }

        .copy-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: #4B5563;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.2s ease;
            opacity: 0;
            border: none;
            outline: none;
            z-index: 20;
        }

        .code-container:hover .copy-btn {
            opacity: 1;
        }

        .copy-btn:hover {
            background-color: #374151;
        }

        /* Tab Styles */
        .tab-active {
            border-bottom: 3px solid #a777e3;
            color: #a777e3;
            font-weight: 600;
            background-color: #f8f9fa;
        }

        .tab-inactive {
            color: #6b7280;
            background-color: #ffffff;
            cursor: pointer;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            .grid {
                grid-template-columns: 1fr;
            }
            .text-2xl {
                font-size: 1.5rem;
            }
            .px-6 {
                padding-left: 1rem;
                padding-right: 1rem;
            }
        }

        @media (max-width: 480px) {
            .text-xl {
                font-size: 1.25rem;
            }
            .p-6 {
                padding: 1rem;
            }
            .grid {
                gap: 1rem;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-100">
    <!-- Header Section -->
    <header class="gradient-bg text-white py-6 shadow-lg">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="flex items-center mb-4 md:mb-0">
                    <i class="fas fa-shield-alt text-3xl mr-3"></i>
                    <h1 class="text-2xl md:text-3xl font-bold">SecureCoder Pro</h1>
                </div>
                <nav class="flex space-x-6">
                    <a href="#encrypt" class="hover:text-gray-200 transition-colors">Encrypt</a>
                    <a href="#decrypt" class="hover:text-gray-200 transition-colors">Decrypt</a>
                    <a href="#about" class="hover:text-gray-200 transition-colors">About</a>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <!-- Tabs Container -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="flex border-b">
                <button id="encrypt-tab" class="tab-active flex-1 px-6 py-4 text-lg focus:outline-none transition-all duration-300">
                    <i class="fas fa-lock mr-2"></i>Encrypt
                </button>
                <button id="decrypt-tab" class="tab-inactive flex-1 px-6 py-4 text-lg focus:outline-none transition-all duration-300">
                    <i class="fas fa-unlock mr-2"></i>Decrypt
                </button>
            </div>

            <!-- Encrypt Section -->
            <div id="encrypt-section" class="p-6">
                <div class="mb-6">
                    <label for="encrypt-input" class="block text-gray-700 font-medium mb-2">
                        Text to Encrypt
                    </label>
                    <textarea
                        id="encrypt-input"
                        rows="5"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"
                        placeholder="Enter your text here..."
                    ></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label for="encryption-key" class="block text-gray-700 font-medium mb-2">
                            Encryption Key (Optional)
                        </label>
                        <input
                            type="text"
                            id="encryption-key"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"
                            placeholder="Enter encryption key"
                        />
                    </div>
                    
                    <div>
                        <label for="encryption-language" class="block text-gray-700 font-medium mb-2">
                            Output Format
                        </label>
                        <select
                            id="encryption-language"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"
                        >
                            <!-- Web Development -->
                            <optgroup label="Web Development">
                                <option value="html">HTML</option>
                                <option value="css">CSS</option>
                                <option value="javascript">JavaScript</option>
                                <option value="php">PHP</option>
                            </optgroup>
                            
                            <!-- Programming Languages -->
                            <optgroup label="Programming Languages">
                                <option value="python">Python</option>
                                <option value="java">Java</option>
                                <option value="cpp">C++</option>
                                <option value="csharp">C#</option>
                                <option value="ruby">Ruby</option>
                                <option value="go">Go</option>
                                <option value="rust">Rust</option>
                                <option value="swift">Swift</option>
                            </optgroup>
                            
                            <!-- Scripting & Others -->
                            <optgroup label="Scripting & Others">
                                <option value="bash">Bash</option>
                                <option value="powershell">PowerShell</option>
                                <option value="sql">SQL</option>
                                <option value="json">JSON</option>
                                <option value="yaml">YAML</option>
                                <option value="xml">XML</option>
                                <option value="plain">Plain Text</option>
                            </optgroup>
                        </select>
                    </div>
                </div>

                <button
                    id="encrypt-btn"
                    class="gradient-bg text-white px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-all duration-300 flex items-center"
                >
                    <i class="fas fa-lock mr-2"></i>
                    <span>Encrypt Now</span>
                </button>

                <div class="mt-8">
                    <label class="block text-gray-700 font-medium mb-2">
                        Encrypted Output
                    </label>
                    <div class="code-container">
                        <button id="copy-encrypted" class="copy-btn">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                        <pre id="encrypted-output">Your encrypted code will appear here...</pre>
                    </div>
                </div>
            </div>

            <!-- Decrypt Section -->
            <div id="decrypt-section" class="p-6 hidden">
                <div class="mb-6">
                    <label for="decrypt-input" class="block text-gray-700 font-medium mb-2">
                        Encrypted Code
                    </label>
                    <textarea
                        id="decrypt-input"
                        rows="8"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"
                        placeholder="Paste encrypted code here..."
                    ></textarea>
                </div>

                <div class="mb-6">
                    <label for="decryption-key" class="block text-gray-700 font-medium mb-2">
                        Decryption Key
                    </label>
                    <input
                        type="text"
                        id="decryption-key"
                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-300"
                        placeholder="Enter decryption key if used"
                    />
                </div>

                <button
                    id="decrypt-btn"
                    class="gradient-bg text-white px-6 py-3 rounded-lg font-medium hover:opacity-90 transition-all duration-300 flex items-center"
                >
                    <i class="fas fa-unlock mr-2"></i>
                    <span>Decrypt Now</span>
                </button>

                <div class="mt-8">
                    <label class="block text-gray-700 font-medium mb-2">
                        Decrypted Result
                    </label>
                    <div class="code-container">
                        <button id="copy-decrypted" class="copy-btn">
                            <i class="fas fa-copy"></i> Copy
                        </button>
                        <pre id="decrypted-output">Decrypted text will appear here...</pre>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Secure Encoder Class
        class SecureEncoder {
            constructor() {
                this.signature = "ilaaa Pedia";
                this.magicBytes = [0x69, 0x6C, 0x61, 0x61, 0x61, 0x20, 0x50, 0x65, 0x64, 0x69, 0x61];
            }

            async encrypt(text, key = '') {
                const processedText = `${this.signature}\n${text}`;
                const sessionKey = await this.generateKey(key);
                return {
                    encrypted: await this.performEncryption(processedText, sessionKey),
                    sessionKey
                };
            }

            async decrypt(encryptedText, key = '') {
                const sessionKey = await this.generateKey(key);
                const decrypted = await this.performDecryption(encryptedText, sessionKey);
                const parts = decrypted.split('\n');
                if (parts.length >= 2 && parts[0] === this.signature) {
                    return parts.slice(1).join('\n');
                }
                return decrypted;
            }

            async generateKey(userKey) {
                const baseKey = userKey + this.signature;
                
                if (window.crypto && window.crypto.subtle) {
                    const encoder = new TextEncoder();
                    const data = encoder.encode(baseKey);
                    const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                    const hashArray = Array.from(new Uint8Array(hashBuffer));
                    return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                }
                
                return this.fallbackHash(baseKey);
            }

            async performEncryption(text, key) {
                const textBytes = new TextEncoder().encode(text);
                const keyBytes = new TextEncoder().encode(key);
                const encrypted = new Uint8Array(textBytes.length);
                
                for (let i = 0; i < textBytes.length; i++) {
                    encrypted[i] = textBytes[i] ^ keyBytes[i % keyBytes.length] ^ this.magicBytes[i % this.magicBytes.length];
                }
                
                return btoa(String.fromCharCode(...encrypted));
            }

            async performDecryption(encryptedText, key) {
                try {
                    const encrypted = atob(encryptedText);
                    const encryptedBytes = new Uint8Array(encrypted.length);
                    
                    for (let i = 0; i < encrypted.length; i++) {
                        encryptedBytes[i] = encrypted.charCodeAt(i);
                    }
                    
                    const keyBytes = new TextEncoder().encode(key);
                    const decrypted = new Uint8Array(encryptedBytes.length);
                    
                    for (let i = 0; i < encryptedBytes.length; i++) {
                        decrypted[i] = encryptedBytes[i] ^ keyBytes[i % keyBytes.length] ^ this.magicBytes[i % this.magicBytes.length];
                    }
                    
                    return new TextDecoder().decode(decrypted);
                } catch (error) {
                    throw new Error('Invalid encrypted data');
                }
            }

            fallbackHash(input) {
                let hash = 0;
                for (let i = 0; i < input.length; i++) {
                    const char = input.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16).padStart(8, '0');
            }
        }

        // Initialize encoder
        const encoder = new SecureEncoder();

        // Format encrypted output based on language
        function formatEncryptedOutput(encrypted, key, language) {
            const metadata = `Tool: SecureCoder Pro\nSignature: ${encoder.signature}`;
            
            switch (language) {
                case 'html':
                    return `<!-- SecureCoder Pro - Encrypted Output -->
<!-- ${metadata} -->
<!-- Key: ${key || '<auto-generated>'} -->
<div class="encrypted-data" data-encrypted="${encrypted}">
    <!-- Encrypted content below -->
    ${encrypted}
</div>`;

                case 'css':
                    return `/* SecureCoder Pro - Encrypted Output */
/* ${metadata} */
/* Key: ${key || '<auto-generated>'} */
.encrypted-data {
    /* Encrypted content below */
    content: "${encrypted}";
}`;

                case 'javascript':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

const encryptedData = "${encrypted}";`;

                case 'python':
                    return `# SecureCoder Pro - Encrypted Output
# ${metadata}
# Key: ${key || '<auto-generated>'}

encrypted_data = "${encrypted}"`;

                case 'java':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

public class EncryptedData {
    private static final String encryptedContent = "${encrypted}";
}`;

                case 'cpp':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

const std::string encryptedData = "${encrypted}";`;

                case 'csharp':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

public static class EncryptedData {
    public const string EncryptedContent = "${encrypted}";
}`;

                case 'ruby':
                    return `# SecureCoder Pro - Encrypted Output
# ${metadata}
# Key: ${key || '<auto-generated>'}

encrypted_data = "${encrypted}"`;

                case 'go':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

package main

const encryptedData = "${encrypted}"`;

                case 'rust':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

const ENCRYPTED_DATA: &str = "${encrypted}";`;

                case 'swift':
                    return `// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

let encryptedData = "${encrypted}"`;

                case 'php':
                    return `<?php
// SecureCoder Pro - Encrypted Output
// ${metadata}
// Key: ${key || '<auto-generated>'}

$encryptedData = "${encrypted}";`;

                case 'bash':
                    return `#!/bin/bash
# SecureCoder Pro - Encrypted Output
# ${metadata}
# Key: ${key || '<auto-generated>'}

ENCRYPTED_DATA="${encrypted}"`;

                case 'powershell':
                    return `# SecureCoder Pro - Encrypted Output
# ${metadata}
# Key: ${key || '<auto-generated>'}

$encryptedData = "${encrypted}"`;

                case 'sql':
                    return `-- SecureCoder Pro - Encrypted Output
-- ${metadata}
-- Key: ${key || '<auto-generated>'}

CREATE TABLE IF NOT EXISTS encrypted_data (
    id INT PRIMARY KEY,
    content VARCHAR(MAX) DEFAULT '${encrypted}'
);`;

                case 'json':
                    return `{
    "metadata": {
        "tool": "SecureCoder Pro",
        "signature": "${encoder.signature}",
        "key": "${key || '<auto-generated>'}"
    },
    "encryptedData": "${encrypted}"
}`;

                case 'yaml':
                    return `# SecureCoder Pro - Encrypted Output
metadata:
  tool: SecureCoder Pro
  signature: ${encoder.signature}
  key: ${key || '<auto-generated>'}
encryptedData: "${encrypted}"`;

                case 'xml':
                    return `<?xml version="1.0" encoding="UTF-8"?>
<!-- SecureCoder Pro - Encrypted Output -->
<!-- ${metadata} -->
<!-- Key: ${key || '<auto-generated>'} -->
<encryptedData>
    <metadata>
        <tool>SecureCoder Pro</tool>
        <signature>${encoder.signature}</signature>
        <key>${key || '<auto-generated>'}</key>
    </metadata>
    <content>${encrypted}</content>
</encryptedData>`;

                default: // plain text
                    return encrypted;
            }
        }

        // Enhanced copy functionality
        function copyToClipboard(text) {
            return navigator.clipboard.writeText(text)
                .catch(err => {
                    // Fallback for older browsers
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    textarea.style.position = 'fixed';
                    textarea.style.opacity = '0';
                    document.body.appendChild(textarea);
                    textarea.select();
                    try {
                        document.execCommand('copy');
                        document.body.removeChild(textarea);
                        return Promise.resolve();
                    } catch (err) {
                        document.body.removeChild(textarea);
                        return Promise.reject(err);
                    }
                });
        }

        function setupCopyButton(buttonId, outputId) {
            const button = document.getElementById(buttonId);
            const output = document.getElementById(outputId);

            button.addEventListener('click', async () => {
                try {
                    await copyToClipboard(output.textContent);
                    
                    // Visual feedback
                    const originalText = button.innerHTML;
                    button.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    button.style.backgroundColor = '#10B981';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.style.backgroundColor = '';
                    }, 2000);
                } catch (err) {
                    console.error('Copy failed:', err);
                    alert('Failed to copy. Please try selecting and copying manually.');
                }
            });
        }

        // Extract encrypted content from formatted output
        function extractEncryptedContent(input) {
            // Try to find the encrypted content using various patterns
            const patterns = [
                /"([A-Za-z0-9+/=]+)"/,                // Basic quoted string
                /content: "([A-Za-z0-9+/=]+)"/,       // CSS format
                /data-encrypted="([A-Za-z0-9+/=]+)"/, // HTML format
                /<content>([A-Za-z0-9+/=]+)<\/content>/, // XML format
                /encryptedData": "([A-Za-z0-9+/=]+)"/, // JSON format
                /encryptedData: "([A-Za-z0-9+/=]+)"/, // YAML format
                /DEFAULT '([A-Za-z0-9+/=]+)'/,        // SQL format
                /ENCRYPTED_DATA="([A-Za-z0-9+/=]+)"/, // Bash format
                /[^a-zA-Z]([A-Za-z0-9+/=]{20,})[^a-zA-Z]/ // Generic base64
            ];

            for (const pattern of patterns) {
                const match = input.match(pattern);
                if (match && match[1]) {
                    return match[1];
                }
            }

            // If no pattern matches, return the input as is
            return input.trim();
        }

        // Tab switching functionality
        document.addEventListener('DOMContentLoaded', () => {
            const encryptTab = document.getElementById('encrypt-tab');
            const decryptTab = document.getElementById('decrypt-tab');
            const encryptSection = document.getElementById('encrypt-section');
            const decryptSection = document.getElementById('decrypt-section');

            function switchToEncrypt() {
                encryptSection.classList.remove('hidden');
                decryptSection.classList.add('hidden');
                encryptTab.classList.add('tab-active');
                encryptTab.classList.remove('tab-inactive');
                decryptTab.classList.remove('tab-active');
                decryptTab.classList.add('tab-inactive');
            }

            function switchToDecrypt() {
                encryptSection.classList.add('hidden');
                decryptSection.classList.remove('hidden');
                encryptTab.classList.remove('tab-active');
                encryptTab.classList.add('tab-inactive');
                decryptTab.classList.add('tab-active');
                decryptTab.classList.remove('tab-inactive');
            }

            encryptTab.addEventListener('click', switchToEncrypt);
            decryptTab.addEventListener('click', switchToDecrypt);

            // Initialize copy buttons
            setupCopyButton('copy-encrypted', 'encrypted-output');
            setupCopyButton('copy-decrypted', 'decrypted-output');
        });

        // Encrypt button handler
        document.getElementById('encrypt-btn').addEventListener('click', async () => {
            const button = document.getElementById('encrypt-btn');
            const input = document.getElementById('encrypt-input').value;
            const key = document.getElementById('encryption-key').value;
            const language = document.getElementById('encryption-language').value;

            if (!input.trim()) {
                alert('Please enter text to encrypt');
                return;
            }

            try {
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Encrypting...';

                const result = await encoder.encrypt(input, key);
                const formattedOutput = formatEncryptedOutput(result.encrypted, key, language);
                document.getElementById('encrypted-output').textContent = formattedOutput;
            } catch (error) {
                console.error('Encryption failed:', error);
                alert('Encryption failed. Please try again.');
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-lock mr-2"></i>Encrypt Now';
            }
        });

        // Decrypt button handler
        document.getElementById('decrypt-btn').addEventListener('click', async () => {
            const button = document.getElementById('decrypt-btn');
            const input = document.getElementById('decrypt-input').value;
            const key = document.getElementById('decryption-key').value;

            if (!input.trim()) {
                alert('Please enter encrypted text to decrypt');
                return;
            }

            try {
                button.disabled = true;
                button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> Decrypting...';

                const encryptedContent = extractEncryptedContent(input);
                const decrypted = await encoder.decrypt(encryptedContent, key);
                document.getElementById('decrypted-output').textContent = decrypted;
            } catch (error) {
                console.error('Decryption failed:', error);
                alert('Decryption failed. Please check your input and key.');
            } finally {
                button.disabled = false;
                button.innerHTML = '<i class="fas fa-unlock mr-2"></i>Decrypt Now';
            }
        });
    </script>
</body>
</html>